Question 1

select distinct f.title, c.name, count(*) over (partition by f.title ) from category c
join film_category  fc
on c.category_id=fc.category_id
join film f
on f.film_id=fc.film_id
join inventory i
on i.film_id=f.film_id
join rental r
on r.inventory_id = i.inventory_id
where c.name in ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')
Order by c.name


Question 2

select f.title, c.name, rental_duration, ntile(4) over (partition by rental_duration)
from category c
join film_category  fc
on c.category_id=fc.category_id
join film f
on f.film_id=fc.film_id
where c.name in ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')

Option 2 Question 2

select f.title, c.name, rental_duration, ntile(4) over (order by rental_duration)
from category c
join film_category  fc
on c.category_id=fc.category_id
join film f
on f.film_id=fc.film_id
where c.name in ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')

Question 3

select distinct category_name, quartile, count(1) over (partition by category_name,quartile)
from(select c.name as category_name, ntile(4) over (order by rental_duration) as quartile
from category c
join film_category  fc
on c.category_id=fc.category_id
join film f
on f.film_id=fc.film_id
where c.name in ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music'))sub
order by 1,2


Project Set questions 2

Question 1

select date_part ('month', rental_date) rental_month, date_part('year', rental_date) rental_year, store_id, count(1)
from rental r
join inventory i 
on r.inventory_id=i.inventory_id
group by 1,2,3 
order by 4 desc


Question 2

select date_trunc('month',payment_date) pay_month, first_name||' '||last_name, count(*), sum(amount)
from customer c
join payment p
on c.customer_id=p.customer_id
where c.customer_id in (
	Select customer_id from(
select first_name||' '||last_name, c.customer_id customer_id, sum (amount)
from customer c
join payment p
on c.customer_id=p.customer_id
where date_part('year',payment_date) = 2007
group by 1,2
order by 3 desc
limit 10)sub
)
group by 1,2
order by 2

Question 3




